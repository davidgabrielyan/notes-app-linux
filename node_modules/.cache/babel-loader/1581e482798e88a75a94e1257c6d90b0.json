{"ast":null,"code":"'use strict';\n\nconst Packet = require('../packets/packet');\n\nclass TextRow {\n  constructor(columns) {\n    this.columns = columns || [];\n  }\n\n  static fromPacket(packet) {\n    // packet.reset(); // set offset to starting point?\n    const columns = [];\n\n    while (packet.haveMoreData()) {\n      columns.push(packet.readLengthCodedString());\n    }\n\n    return new TextRow(columns);\n  }\n\n  static toPacket(columns, encoding) {\n    const sequenceId = 0; // TODO remove, this is calculated now in connecton\n\n    let length = 0;\n    columns.forEach(val => {\n      if (val === null || typeof val === 'undefined') {\n        ++length;\n        return;\n      }\n\n      length += Packet.lengthCodedStringLength(val.toString(10), encoding);\n    });\n    const buffer = Buffer.allocUnsafe(length + 4);\n    const packet = new Packet(sequenceId, buffer, 0, length + 4);\n    packet.offset = 4;\n    columns.forEach(val => {\n      if (val === null) {\n        packet.writeNull();\n        return;\n      }\n\n      if (typeof val === 'undefined') {\n        packet.writeInt8(0);\n        return;\n      }\n\n      packet.writeLengthCodedString(val.toString(10), encoding);\n    });\n    return packet;\n  }\n\n}\n\nmodule.exports = TextRow;","map":null,"metadata":{},"sourceType":"script"}