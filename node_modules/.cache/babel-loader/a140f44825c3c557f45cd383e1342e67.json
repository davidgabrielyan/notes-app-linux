{"ast":null,"code":"'use strict';\n\nconst ClientConstants = require('../constants/client');\n\nconst Packet = require('../packets/packet');\n\nclass SSLRequest {\n  constructor(flags, charset) {\n    this.clientFlags = flags | ClientConstants.SSL;\n    this.charset = charset;\n  }\n\n  toPacket() {\n    const length = 36;\n    const buffer = Buffer.allocUnsafe(length);\n    const packet = new Packet(0, buffer, 0, length);\n    buffer.fill(0);\n    packet.offset = 4;\n    packet.writeInt32(this.clientFlags);\n    packet.writeInt32(0); // max packet size. todo: move to config\n\n    packet.writeInt8(this.charset);\n    return packet;\n  }\n\n}\n\nmodule.exports = SSLRequest;","map":null,"metadata":{},"sourceType":"script"}